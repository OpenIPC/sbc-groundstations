diff -ur /path/to/a/CMakeLists.txt ./CMakeLists.txt
--- /path/to/a/CMakeLists.txt	2025-10-24 02:05:37.000000000 +0200
+++ ./CMakeLists.txt	2025-10-25 20:54:30.578651242 +0200
@@ -11,16 +11,26 @@
 set(LV_CONF_BUILD_DISABLE_DEMOS 1)
 set(LV_CONF_BUILD_DISABLE_EXAMPLES 1)
 add_subdirectory(lvgl)
+
+# Set include directories for LVGL BEFORE any other targets
 target_include_directories(lvgl PUBLIC 
     ${PROJECT_SOURCE_DIR}
-    /usr/include/libdrm
-    /usr/include/drm
+    ${PROJECT_SOURCE_DIR}/lvgl
 )
+
 set(CMAKE_C_STANDARD 99) # LVGL officially supports C99 and above
 set(CMAKE_CXX_STANDARD 17) #C17
 set(CMAKE_CXX_STANDARD_REQUIRED ON)
 
+pkg_check_modules(LIBDRM REQUIRED libdrm)
+pkg_check_modules(CAIRO IMPORTED_TARGET REQUIRED cairo)
+pkg_check_modules(SPDLOG REQUIRED spdlog)
+
 find_package(PNG REQUIRED)
+find_package(fmt REQUIRED)
+find_package(spdlog REQUIRED)
+
+
 include_directories(${PNG_INCLUDE_DIR})
 
 # Simulator
@@ -69,7 +79,6 @@
         src/input.h
         src/input.cpp
 )
-# LVGL setup
 
 add_compile_options("-Wno-address-of-packed-member")
 
@@ -136,8 +145,6 @@
 file(GLOB ICONS src/icons/*.png)
 file(GLOB OSD_CONFIGS *_osd.json)
 
-include_directories("/usr/include/libdrm" "/usr/include/cairo" "/usr/include/spdlog")
-
 configure_file("${PROJECT_NAME}_config.h.in" "${PROJECT_NAME}_config.h")
 
 # Option to control wmenu simulator build
@@ -147,16 +154,15 @@
   add_definitions(-DUSE_SIMULATOR)
   target_compile_definitions(lvgl PRIVATE USE_SIMULATOR)
   pkg_check_modules(LIBSDL REQUIRED sdl2)
-  add_executable(${PROJECT_NAME} ${SIMULATOR_SOURCES} lvgl)
-  target_link_libraries(${PROJECT_NAME} lvgl ${LIBSDL_LIBRARIES} ${PNG_LIBRARIES})
+  add_executable(${PROJECT_NAME} ${SIMULATOR_SOURCES})
+  target_link_libraries(${PROJECT_NAME} lvgl ${LIBSDL_LIBRARIES} ${PNG_LIBRARIES} ${LIBDRM_LIBRARIES})
 else()
-  find_package(spdlog REQUIRED)
   find_package(nlohmann_json 3 REQUIRED)
   find_package(yaml-cpp REQUIRED)
   pkg_check_modules(LIBGPIOD REQUIRED libgpiod)
-  add_executable(${PROJECT_NAME} ${SOURCE_FILES})
-  target_link_libraries(${PROJECT_NAME} rockchip_mpp pthread drm m cairo spdlog::spdlog nlohmann_json::nlohmann_json yaml-cpp rt lvgl ${LIBGPIOD_LIBRARIES} ${PNG_LIBRARIES})
-  # Embed gstreamer
+  include_directories(${LIBGPIOD_INCLUDE_DIR})
+  
+  # GStreamer setup
   find_package(PkgConfig REQUIRED)
   pkg_search_module(GST REQUIRED
           gstreamer-1.0>=1.4
@@ -164,7 +170,33 @@
   )
   pkg_search_module(gstreamer REQUIRED IMPORTED_TARGET gstreamer-1.0>=1.4)
   pkg_search_module(gstreamer-app REQUIRED IMPORTED_TARGET gstreamer-app-1.0>=1.4)
-  target_link_libraries(${PROJECT_NAME} PkgConfig::gstreamer PkgConfig::gstreamer-app)  
+  
+  add_executable(${PROJECT_NAME} ${SOURCE_FILES})
+  
+  # Add include directories for the main target
+  target_include_directories(${PROJECT_NAME} PRIVATE
+      ${PROJECT_SOURCE_DIR}
+      ${PROJECT_SOURCE_DIR}/lvgl
+      ${LIBDRM_INCLUDE_DIRS}
+  )
+  
+  target_link_libraries(${PROJECT_NAME} 
+      rockchip_mpp 
+      pthread 
+      drm 
+      m 
+      PkgConfig::CAIRO
+      spdlog::spdlog 
+      fmt::fmt
+      nlohmann_json::nlohmann_json 
+      yaml-cpp 
+      rt 
+      lvgl 
+      ${LIBGPIOD_LIBRARIES} 
+      ${PNG_LIBRARIES}
+      PkgConfig::gstreamer 
+      PkgConfig::gstreamer-app
+  )
 endif()
 
 if(CMAKE_BUILD_TYPE MATCHES "Debug")
diff -ur /path/to/a/src/input.cpp ./src/input.cpp
--- /path/to/a/src/input.cpp	2025-10-24 02:05:37.000000000 +0200
+++ ./src/input.cpp	2025-10-25 20:51:56.553475902 +0200
@@ -10,8 +10,7 @@
 #include <yaml-cpp/yaml.h>
 #include <glob.h>
 #include "main.h"
-#include "../../lvgl/lvgl.h"
-#include "../../lvgl/src/core/lv_global.h"
+#include "lvgl/lvgl.h"
 #include "input.h"
 #include "gsmenu/gs_system.h"
 
diff -ur /path/to/a/src/input.h ./src/input.h
--- /path/to/a/src/input.h	2025-10-24 02:05:37.000000000 +0200
+++ ./src/input.h	2025-10-25 20:51:19.707097269 +0200
@@ -3,8 +3,7 @@
 #define INPUT_H
 
 #include <stdint.h>
-#include "../../lvgl/lvgl.h"
-#include "../../lvgl/src/core/lv_global.h"
+#include "lvgl/lvgl.h"
 
 typedef enum {
     GSMENU_CONTROL_MODE_NAV = 0,
diff -ur /path/to/a/src/main.cpp ./src/main.cpp
--- /path/to/a/src/main.cpp	2025-10-24 02:05:37.000000000 +0200
+++ ./src/main.cpp	2025-10-25 20:58:34.203738661 +0200
@@ -586,7 +586,7 @@
 void set_control_verbose(MppApi * mpi,  MppCtx ctx,MpiCmd control,RK_U32 enable){
     RK_U32 res = mpi->control(ctx, control, &enable);
     if(res){
-        spdlog::warn("Could not set control {} {}", control, enable);
+        spdlog::warn("Could not set control {} {}", static_cast<int>(control), enable);
         assert(false);
     }
 }
